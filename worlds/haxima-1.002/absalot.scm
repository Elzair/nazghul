;;----------------------------------------------------------------------------
;; Map
;;----------------------------------------------------------------------------
(kern-mk-map
 'm_absalot 41 36 pal_expanded
 (list
		"tt tt tt tt tc .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. cc .. .. .. .. .. .. .. .. .. .. .. .. .. ta tt tt tt tt tt "
		"tt xx xx xx xx xx xx xx xx xx xx xx xx .. .. .. xx xx xx xx .. cc .. xx xx xx xx .. .. %7 .. .. .. .. .. t% ta tt tt tt tt "
		"tt xx ,, xx xx xx xx xx xx xx xx xx xx .. .. .. xx ,, ,, xx .. cc .. xx ,, ,, xx .. %b %% %d .. .. .. .. .. .. .. t% ta tt "
		"tt xx ?? xx .L .I .B .R .A .R .Y xx xx xx .. .. xx ,, .. .. .. cc .. ,, ,, ,, xx .. .. %e .. .. .. .. .. .. .. .. .. t% ta "
		"tc rr ,, ,, ,, ,, tt ,, ,, .. ,, ,, ,, xx .. .. xx xx xx .. .. cc .. xx xx xx xx .. .. .. xx xx xx xx xx xx xx xx xx .. .. "
		".. xx ,, ,, ,, t3 tt td ,, ,, ,, ,, ,, rr .. .. .. .. .. .. .. cc .. .. .. .. .. .. .. xx bb .A .C .A .D .E .M .Y xx xx .. "
		".. xx .. ,, 00 te ,, 00 ,, .. 00 ,, ,, xx .. .. xx xx rr rr .. cc .. xx xx xx .. .. .. bb ,, ,, ,, ,, ,, ,, ,, ,, ,, xx .. "
		".. xx ,, ,, 00 ,, ,, 00 ,, ,, 00 ,, ,, xx .. .. xx ,, ,, rr .. cc .. ,, ,, ,, xx .. .. xx rr ,, ,, ,, ,, .. ,, ,, ,, xx .. "
		".. xx ,, ,, 00 ,, ,, 00 ,, .. 00 ,, ,, xx .. .. xx ,, ,, ,, .. cc .. xx ,, ,, xx .. .. xx ,, ,, 00 ,, ,, ,, 00 ,, ,, xx .. "
		".. rr ,, ,, .. ,, ,, 00 ,, ,, 00 ,, ,, rr .. .. xx xx .. xx .. cc .. bb xx xx xx .. .. xx ,, .. .. ,, ,, ,, 00 ,, ,, xx .. "
		".. xx ,, ,, 00 ,, ,, 00 ,, ,, 00 ,, ,, rr .. .. .. .. .. .. .. cc .. .. .. .. .. %7 .. xx ,, ,, 00 00 00 00 00 ,, ,, xx .. "
		".. tC t7 ,, ,, ,, ,, ,, ,, ,, ,, ,, ,, xx tC t7 pp ,, pp ,, ,, cc ,, ,, pp .. %3 %% %% rr ,, ,, ,, ,, ,, ,, ,, ,, ,, xx .. "
		".. tb tt bb ,, ,, ,, ,, ,, ,, ,, .. ,, xx tb tt td ,, .. ,, ,, cc ,, ,, ,, .. %a %% .. rr .. ,, ,, .. ,, ,, rr ,, ,, xx .. "
		".. t% ta td xx xx xx ,, .. xx xx xx rr xx t% te pp ,, ,, ,, ,, cc ,, ,, ,, ,, .. %e .. rr rr xx xx xx ,, rr xx xx xx xx .. "
		".. .. .. .. .. .. .. cc .. .. .. .. .. .. .. .. .. .. ,, ,, .. cc cc ,, ,, ,, ,, .. .. .. .. .. .. .. cc .. .. .. .. .. .. "
		".. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. ,, ,, cc cc cc cc cc cc cc ,, ,, .. .. .. .. .. .. .. cc .. .. .. .. .. .. "
		"cc cc cc cc cc .. cc cc cc cc cc cc .. cc cc cc cc cc cc .F .O .R .U .M cc cc cc cc cc cc cc .. cc cc .. cc cc cc cc cc cc "
		".. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. ,, ,, cc cc .. cc cc cc cc ,, ,, .. .. .. .. cc .. .. .. .. .. bb .. .. bb "
		"%5 .. .. .. xx xx ,, xx .. .. xx xx ,, xx .. .. ,, ,, ,, .. cc cc cc ,, ,, ,, ,, .. .. .. xx ,, rr xx ,, xx .. .. .. .. .. "
		"%% %5 .. .. xx ,, ,, xx .. .. xx .. ,, xx .. .. pp ,, ,, .. .. cc ,, .. ,, ,, pp .. .. xx ,, ,, xx ,, .. xx tC t7 tA .. bb "
		"%% %% .. .. xx ,, ,, rr %5 .. xx ,, ,, xx .. .. ,, ,, ,, ,, ,, cc ,, ,, ,, ,, ,, .. .. xx .. ,, xx ,, .. .. tb tt td .. .. "
		"%% %% .. .. xx xx rr rr %% .. xx xx xx xx t7 tA .. ,, pp ,, ,, cc ,, ,, pp ,, pp .. .. rr xx xx .. .. .. xx .. bb .. .. bb "
		"%% %% %5 .. .. .. .. %% %c .. .. .. .. tb tt td .. .. .. .. .. cc .. .. .. .. .. tC t7 tA .. .. .. .. .. .. .. .. .. .. .. "
		"%% %% %c .. %3 %% %% %% .. .. .. .. .. t% te t# .. .. .. .. .. cc tC t7 tA .. .. tb tt td .. .. .. .. .. .. .. bb .. .. bb "
		"%% %c .. .. %a %% %% %% .. .. .. xx xx xx xx bb xx rr .. .. .. cc tb tt td tA .. bb tt bb .. bb .. bb .. .. .. .. .. .. .. "
		"%% .. .. .. .. %a %% %c .. .. xx .. ,, ,, ,, ,, ,, xx xx .. .. cc t% te tF t7 bb .G .A .R .. .E .N .S bb .. .. bb .. .. bb "
		"%% .. %3 %5 .. .. %% .. .. .. xx .M .. .G .I .C .K .S xx .. .. cc .. t% tb tt td .. .. tt tt tt .. .. .. .. .. .. .. .. .. "
		"%% %% %% %% %5 .. %% %5 .. .. xx ,, ,, ,, ,, ,, ,, ,, sA .. .. bb .. .. bb te bb .. t3 tt tt tt t5 .. bb .. bb .. .. .. bb "
		"%% %% %% bb %% %% %% %% %5 .. xx ,, ,, ,, .. ,, ,, ,, ,, cc cc .. .. .. .. .. .. .. ta tt tt tt tt tA .. .. .. .. .. .. .. "
		"%% %% %% %% ~5 %% %% %% %c .. xx ,, ,, ,, ,, ,, .. .. xx .. .. cc .. .. .. .. .. .. t% tt tt tt tt tt tt t5 tA .. .. bb .. "
		"%% bb %% ~3 ~~ %% %% bb .. .. .. .F .U .T .U .R .E .S xx .. .. cc .. .. .. %3 %% %5 .. ta tt tt tt tt tt tt tt t5 .. .. .. "
		"%% .. %% ~2 ~~ ~5 %% %% .. .. xx xx ,, ,, ,, ,, ,, xx xx .. .. cc bb .. bb %% bb %% %5 .. t% ta tt tt bb tt bb tt bb tC t3 "
		"%% bb %% ~a ~8 ~c %% bb .. .. %a xx xx .. aa ,, xx xx .. %7 .. cc .. %3 %% %% %% %% %% %5 .. t% tt tt tt tt tt tt tt tt tt "
		"%% %% %% %% %% %% %% %c .. %7 .. %% xx ,, ,, ,, xx %% %% %% .. .. .. %% %% %% %% %% %% %% %5 .. tt bb tt tt tt tt || || || "
		"%% %% %% bb %% bb %% .. .. %% .. %% xx xx xx xx xx %% %% %c .. cc .. %a %% %% %% %% %% %% %% bb ta tt tt tt tt || || || || "
		"%% %% %% %% %% %% %% .. %% %% %% %% %% %% %% %% %% %% %% .. .. cc .. .. %% %% %% %% %% %% %% .. .. t% tt || || || || || || "
))

;;----------------------------------------------------------------------------
;; NPC's
;;----------------------------------------------------------------------------


;;----------------------------------------------------------------------------
;; Place
;;----------------------------------------------------------------------------
(kern-mk-place
 'p_absalot     ; tag
 "Absalot"      ; name
 s_ruin      ; sprite
 m_absalot      ; map
 #f              ; wraps
 #f              ; underground
 #f              ; large-scale (wilderness)
 #f              ; tmp combat place
 nil ; subplaces
 nil ; neighbors

 (list ; objects

  (put (mk-ladder-down 'p_old_absalot 11 27) 2 2)
  (put (mk-clock) 12 4)
  (put (mk-broken-clock s_clock_stopped s_clock_stopped "The clock is broken beyond repair") 34 8)
  
  )

 nil ; hooks

 (list  ;; edge entrances
  (list east  0 16)
  (list south 21 0) 
  (list north 21 35)
  (list west  40 16)
  (list northeast 7 35)
  )
 )

;; corpses
(put-random-stuff p_absalot
                  (mk-rect 0 0 41 36)
                  (lambda (loc)
                    (or (eqv? (kern-place-get-terrain loc) t_grass)
                        (eqv? (kern-place-get-terrain loc) t_flagstones)
                        (eqv? (kern-place-get-terrain loc) t_bog)
                        (eqv? (kern-place-get-terrain loc) t_cobblestone)
                        (eqv? (kern-place-get-terrain loc) t_trees)
                        ))
                  (lambda (loc)
                    (kern-obj-put-at (mk-corpse) loc))
                  20)

(mk-place-music p_absalot 'ml-dungeon-adventure)
