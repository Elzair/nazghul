;;----------------------------------------------------------------------------
;; Map
;;----------------------------------------------------------------------------
(kern-mk-map
 'm_absalot 41 36 pal_expanded
 (list
      "tt tt tt tt tt .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. cc .. .. .. .. .. .. .. .. .. .. .. .. .. tt tt tt tt tt tt "
      "tt xx xx xx xx xx xx xx xx xx xx xx xx .. .. .. xx xx xx xx .. cc .. xx xx xx xx .. .. %% .. .. .. .. .. .. tt tt tt tt tt "
      "tt xx ,, xx xx xx xx xx xx xx xx xx xx .. .. .. xx ,, ,, xx .. cc .. xx ,, ,, xx .. %% %% %% .. .. .. .. .. .. .. .. tt tt "
      "tt xx ?? xx .L .I .B .R .A .R .Y xx xx xx .. .. xx ,, .. .. .. cc .. ,, ,, ,, xx .. .. %% .. .. .. .. .. .. .. .. .. .. tt "
      "tt rr ,, ,, ,, ,, tt ,, ,, .. ,, ,, ,, xx .. .. xx xx xx .. .. cc .. xx xx xx xx .. .. .. xx xx xx xx xx xx xx xx xx .. .. "
      ".. xx ,, ,, ,, tt tt tt ,, ,, ,, ,, ,, rr .. .. .. .. .. .. .. cc .. .. .. .. .. .. .. xx bb .A .C .A .D .E .M .Y xx xx .. "
      ".. xx .. ,, 00 tt ,, 00 ,, .. 00 ,, ,, xx .. .. xx xx rr rr .. cc .. xx xx xx .. .. .. bb ,, ,, ,, ,, ,, ,, ,, ,, ,, xx .. "
      ".. xx ,, ,, 00 ,, ,, 00 ,, ,, 00 ,, ,, xx .. .. xx ,, ,, rr .. cc .. ,, ,, ,, xx .. .. xx rr ,, ,, ,, ,, .. ,, ,, ,, xx .. "
      ".. xx ,, ,, 00 ,, ,, 00 ,, .. 00 ,, ,, xx .. .. xx ,, ,, ,, .. cc .. xx ,, ,, xx .. .. xx ,, ,, 00 ,, ,, ,, 00 ,, ,, xx .. "
      ".. rr ,, ,, .. ,, ,, 00 ,, ,, 00 ,, ,, rr .. .. xx xx .. xx .. cc .. bb xx xx xx .. .. xx ,, .. .. ,, ,, ,, 00 ,, ,, xx .. "
      ".. xx ,, ,, 00 ,, ,, 00 ,, ,, 00 ,, ,, rr .. .. .. .. .. .. .. cc .. .. .. .. .. %% .. xx ,, ,, 00 00 00 00 00 ,, ,, xx .. "
      ".. .. tt ,, ,, ,, ,, ,, ,, ,, ,, ,, ,, xx .. tt pp ,, pp ,, ,, cc ,, ,, pp .. %% %% %% rr ,, ,, ,, ,, ,, ,, ,, ,, ,, xx .. "
      ".. tt tt bb ,, ,, ,, ,, ,, ,, ,, .. ,, xx tt tt tt ,, .. ,, ,, cc ,, ,, ,, .. %% %% .. rr .. ,, ,, .. ,, ,, rr ,, ,, xx .. "
      ".. .. tt tt xx xx xx ,, .. xx xx xx rr xx .. tt pp ,, ,, ,, ,, cc ,, ,, ,, ,, .. %% .. rr rr xx xx xx ,, rr xx xx xx xx .. "
      ".. .. .. .. .. .. .. cc .. .. .. .. .. .. .. .. .. .. ,, ,, .. cc cc ,, ,, ,, ,, .. .. .. .. .. .. .. cc .. .. .. .. .. .. "
      ".. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. ,, ,, cc cc cc cc cc cc cc ,, ,, .. .. .. .. .. .. .. cc .. .. .. .. .. .. "
      "cc cc cc cc cc .. cc cc cc cc cc cc .. cc cc cc cc cc cc .F .O .R .U .M cc cc cc cc cc cc cc .. cc cc .. cc cc cc cc cc cc "
      ".. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. ,, ,, cc cc .. cc cc cc cc ,, ,, .. .. .. .. cc .. .. .. .. .. bb .. .. bb "
      "%% .. .. .. xx xx ,, xx .. .. xx xx ,, xx .. .. ,, ,, ,, .. cc cc cc ,, ,, ,, ,, .. .. .. xx ,, rr xx ,, xx .. .. .. .. .. "
      "%% %% .. .. xx ,, ,, xx .. .. xx .. ,, xx .. .. pp ,, ,, .. .. cc ,, .. ,, ,, pp .. .. xx ,, ,, xx ,, .. xx .. tt .. .. bb "
      "%% %% .. .. xx ,, ,, rr %% .. xx ,, ,, xx .. .. ,, ,, ,, ,, ,, cc ,, ,, ,, ,, ,, .. .. xx .. ,, xx ,, .. .. tt tt tt .. .. "
      "%% %% .. .. xx xx rr rr %% .. xx xx xx xx tt .. .. ,, pp ,, ,, cc ,, ,, pp ,, pp .. .. rr xx xx .. .. .. xx .. bb .. .. bb "
      "%% %% %% .. .. .. .. %% %% .. .. .. .. tt tt tt .. .. .. .. .. cc .. .. .. .. .. .. tt .. .. .. .. .. .. .. .. .. .. .. .. "
      "%% %% %% .. %% %% %% %% .. .. .. .. .. .. tt .. .. .. .. .. .. cc .. tt .. .. .. tt tt tt .. .. .. .. .. .. .. bb .. .. bb "
      "%% %% .. .. %% %% %% %% .. .. .. xx xx xx xx bb xx rr .. .. .. cc tt tt tt .. .. bb tt bb .. bb .. bb .. .. .. .. .. .. .. "
      "%% .. .. .. .. %% %% %% .. .. xx .. ,, ,, ,, ,, ,, xx xx .. .. cc .. tt .. tt bb .G .A .R .. .E .N .S bb .. .. bb .. .. bb "
      "%% .. %% %% .. .. %% .. .. .. xx .M .. .G .I .C .K .S xx .. .. cc .. .. tt tt tt .. .. tt tt tt .. .. .. .. .. .. .. .. .. "
      "%% %% %% %% %% .. %% %% .. .. xx ,, ,, ,, ,, ,, ,, ,, xx .. .. bb .. .. bb tt bb .. tt tt tt tt tt .. bb .. bb .. .. .. bb "
      "%% %% %% bb %% %% %% %% %% .. xx ,, ,, ,, .. ,, ,, ,, ,, cc cc .. .. .. .. .. .. .. tt tt tt tt tt .. .. .. .. .. .. .. .. "
      "%% %% %% %% ~~ %% %% %% %% .. xx ,, ,, ,, ,, ,, .. .. xx .. .. cc .. .. .. .. .. .. .. tt tt tt tt tt tt tt .. .. .. bb .. "
      "%% bb %% ~~ ~~ %% %% bb .. .. .. .F .U .T .U .R .E .S xx .. .. cc .. .. .. %% %% %% .. tt tt tt tt tt tt tt tt tt .. .. .. "
      "%% .. %% ~~ ~~ ~~ %% %% .. .. xx xx ,, ,, ,, ,, ,, xx xx .. .. cc bb .. bb %% bb %% %% .. .. tt tt tt bb tt bb tt bb .. tt "
      "%% bb %% ~~ ~~ ~~ %% bb .. .. %% xx xx .. aa ,, xx xx .. %% .. cc .. %% %% %% %% %% %% %% .. .. tt tt tt tt tt tt tt tt tt "
      "%% %% %% %% %% %% %% %% .. %% .. %% xx ,, ,, ,, xx %% %% %% .. .. .. %% %% %% %% %% %% %% %% .. tt bb tt tt tt tt || || || "
      "%% %% %% bb %% bb %% .. .. %% .. %% xx xx xx xx xx %% %% %% .. cc .. %% %% %% %% %% %% %% %% bb tt tt tt tt tt || || || || "
      "%% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% .. .. cc .. .. %% %% %% %% %% %% %% .. .. .. tt || || || || || || "
))

;;----------------------------------------------------------------------------
;; NPC's
;;----------------------------------------------------------------------------


;;----------------------------------------------------------------------------
;; Place
;;----------------------------------------------------------------------------
(kern-mk-place
 'p_absalot     ; tag
 "Absalot"      ; name
 s_ruin      ; sprite
 m_absalot      ; map
 #f              ; wraps
 #f              ; underground
 #f              ; large-scale (wilderness)
 #f              ; tmp combat place
 nil ; subplaces
 nil ; neighbors

 (list ; objects

  (put (mk-ladder-down 'p_old_absalot 11 27) 2 2)
  )

 nil ; hooks

 (list  ;; edge entrances
  (list east  0 16)
  (list south 21 0) 
  (list north 21 35)
  (list west  40 16)
  )
 )

;; corpses
(put-random-stuff p_absalot
                  (mk-rect 0 0 41 36)
                  (lambda (loc)
                    (or (eqv? (kern-place-get-terrain loc) t_grass)
                        (eqv? (kern-place-get-terrain loc) t_flagstones)
                        (eqv? (kern-place-get-terrain loc) t_bog)
                        (eqv? (kern-place-get-terrain loc) t_cobblestone)
                        (eqv? (kern-place-get-terrain loc) t_trees)
                        ))
                  (lambda (loc)
                    (kern-obj-put-at (mk-corpse) loc))
                  20)
